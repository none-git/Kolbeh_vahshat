import styles from "./style.module.css"

import { db } from "@/lib/db"

export const revalidate = 600
export default async function Dashboard() {
    const { data, error } = await db.from("stories").select("*")
    if (error) throw new Error(error.message)
    data.sort((a, b) => new Date(b.created_at) - new Date(a.created_at))
    return (
    <section className={styles.body}>
        <h1>داشبورد</h1>
        <section>
            <div className={styles.listView}>
                <div><h3>محبوب ترین داستان ها</h3></div>
                <ul>
                    {[...data].sort((a, b) => b.liked - a.liked).map((item, index) => index < 6 && (
                    <li key={item.slug}>
                        <h4>{item.name}</h4>
                        <p>{item.category === true ? 'رمان' : 'داستان کوتاه'}</p>
                        <span className={styles.liked}>{item.liked}</span>
                    </li>
                    ))}
                </ul>
            </div>
            <div className={styles.numberView}>
                <div className={styles.name}><h3>میانگین بازدید ماهیانه</h3></div>
                <div className={styles.number}>
                    <div><span>528</span></div>
                    <span>+261</span>
                </div>
            </div>
            <div className={styles.numberView}>
                <div className={styles.name}><h3>میانگین فروش ماهیانه</h3></div>
                <div className={styles.number}>
                    <div><span>130</span></div>
                    <span>-87</span>
                </div>
            </div>
            <div></div>
            <div></div>
            <div className={styles.listView}>
                <div><h3>کاربر های برتر</h3></div>
                <ul>
                    <li>
                        <div className={styles.image}></div>
                        <h4>عباس بوعزار</h4>
                        <span className={styles.numberOfSales}>10</span>
                        <div className={`toman-price ${styles.tomanPrice}`}>
                            <span>19102000</span>
                            <svg viewBox="0 0 10 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M0.0895522 0.0594288C0.0179104 0.106972 0 0.279316 0 1.01029C0 1.74127 0.0179104 1.91361 0.0895522 1.96115C0.143284 1.99681 0.985075 2.02058 2.07761 2.02058H3.97015V3.38745C3.97015 4.13625 3.95821 4.75431 3.94627 4.75431C3.87463 4.75431 1.41493 5.41991 1.30149 5.46746C1.17015 5.52094 1.16418 5.5566 1.16418 6.24003C1.16418 6.91158 1.17015 6.95318 1.28358 6.95318C1.34328 6.95318 1.94627 6.80461 2.61493 6.62632C3.28358 6.44803 3.86269 6.29946 3.89851 6.29946C3.95224 6.29946 3.97015 6.47775 3.95821 6.99478L3.9403 7.69604L2.6209 8.05261C1.89851 8.24873 1.27761 8.43296 1.23582 8.45673C1.14627 8.51616 1.13433 9.84142 1.22388 9.89491C1.27164 9.92462 2.9194 9.50862 3.86866 9.23525C3.96418 9.20553 3.97015 9.29468 3.97015 10.513V11.8263L4.11343 11.9214C4.23881 11.9987 4.40597 12.0106 5.06866 11.9927C5.51045 11.9809 5.89254 11.9511 5.92239 11.9274C5.94627 11.8977 5.98209 11.1548 6 10.2693L6.02985 8.65879L7.34328 8.30816C8.30448 8.05261 8.68657 7.92781 8.76418 7.83273C8.89552 7.67821 8.91343 6.59066 8.78209 6.48369C8.72239 6.4302 8.42388 6.48963 7.51642 6.73329C6.8597 6.91158 6.25672 7.07204 6.16716 7.09581L6 7.13146V6.41832C6 6.02609 6.01791 5.70517 6.04776 5.70517C6.07164 5.70517 6.6806 5.54471 7.40299 5.3486C8.27463 5.11683 8.7403 4.96231 8.78806 4.89694C8.86567 4.78997 8.90149 3.77968 8.82985 3.60139C8.81194 3.5479 8.74627 3.5063 8.69254 3.5063C8.63881 3.5063 8.04776 3.65488 7.37313 3.83316C6.69851 4.01145 6.11343 4.16002 6.07761 4.16002C6.01791 4.16002 6 3.90448 6 3.0903V2.02058H7.9403C9.79104 2.02058 9.8806 2.01464 9.9403 1.90767C9.97015 1.84229 10 1.43224 10 0.986519C10 0.338745 9.98209 0.166401 9.90448 0.0950861C9.8209 0.0118857 9.29552 -6.62296e-08 4.99701 -6.62296e-08C2.05373 -6.62296e-08 0.143284 0.0237715 0.0895522 0.0594288Z" fill="#3C4242"/>
                            </svg>
                        </div>
                    </li>
                    <li>
                        <div className={styles.image}></div>
                        <h4>عباس بوعزار</h4>
                        <span className={styles.numberOfSales}>11</span>
                        <div className={`toman-price ${styles.tomanPrice}`}>
                            <span>11370000</span>
                            <svg viewBox="0 0 10 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M0.0895522 0.0594288C0.0179104 0.106972 0 0.279316 0 1.01029C0 1.74127 0.0179104 1.91361 0.0895522 1.96115C0.143284 1.99681 0.985075 2.02058 2.07761 2.02058H3.97015V3.38745C3.97015 4.13625 3.95821 4.75431 3.94627 4.75431C3.87463 4.75431 1.41493 5.41991 1.30149 5.46746C1.17015 5.52094 1.16418 5.5566 1.16418 6.24003C1.16418 6.91158 1.17015 6.95318 1.28358 6.95318C1.34328 6.95318 1.94627 6.80461 2.61493 6.62632C3.28358 6.44803 3.86269 6.29946 3.89851 6.29946C3.95224 6.29946 3.97015 6.47775 3.95821 6.99478L3.9403 7.69604L2.6209 8.05261C1.89851 8.24873 1.27761 8.43296 1.23582 8.45673C1.14627 8.51616 1.13433 9.84142 1.22388 9.89491C1.27164 9.92462 2.9194 9.50862 3.86866 9.23525C3.96418 9.20553 3.97015 9.29468 3.97015 10.513V11.8263L4.11343 11.9214C4.23881 11.9987 4.40597 12.0106 5.06866 11.9927C5.51045 11.9809 5.89254 11.9511 5.92239 11.9274C5.94627 11.8977 5.98209 11.1548 6 10.2693L6.02985 8.65879L7.34328 8.30816C8.30448 8.05261 8.68657 7.92781 8.76418 7.83273C8.89552 7.67821 8.91343 6.59066 8.78209 6.48369C8.72239 6.4302 8.42388 6.48963 7.51642 6.73329C6.8597 6.91158 6.25672 7.07204 6.16716 7.09581L6 7.13146V6.41832C6 6.02609 6.01791 5.70517 6.04776 5.70517C6.07164 5.70517 6.6806 5.54471 7.40299 5.3486C8.27463 5.11683 8.7403 4.96231 8.78806 4.89694C8.86567 4.78997 8.90149 3.77968 8.82985 3.60139C8.81194 3.5479 8.74627 3.5063 8.69254 3.5063C8.63881 3.5063 8.04776 3.65488 7.37313 3.83316C6.69851 4.01145 6.11343 4.16002 6.07761 4.16002C6.01791 4.16002 6 3.90448 6 3.0903V2.02058H7.9403C9.79104 2.02058 9.8806 2.01464 9.9403 1.90767C9.97015 1.84229 10 1.43224 10 0.986519C10 0.338745 9.98209 0.166401 9.90448 0.0950861C9.8209 0.0118857 9.29552 -6.62296e-08 4.99701 -6.62296e-08C2.05373 -6.62296e-08 0.143284 0.0237715 0.0895522 0.0594288Z" fill="#3C4242"/>
                            </svg>
                        </div>
                    </li>
                    <li>
                        <div className={styles.image}></div>
                        <h4>عباس بوعزار</h4>
                        <span className={styles.numberOfSales}>7</span>
                        <div className={`toman-price ${styles.tomanPrice}`}>
                            <span>6054000</span>
                            <svg viewBox="0 0 10 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M0.0895522 0.0594288C0.0179104 0.106972 0 0.279316 0 1.01029C0 1.74127 0.0179104 1.91361 0.0895522 1.96115C0.143284 1.99681 0.985075 2.02058 2.07761 2.02058H3.97015V3.38745C3.97015 4.13625 3.95821 4.75431 3.94627 4.75431C3.87463 4.75431 1.41493 5.41991 1.30149 5.46746C1.17015 5.52094 1.16418 5.5566 1.16418 6.24003C1.16418 6.91158 1.17015 6.95318 1.28358 6.95318C1.34328 6.95318 1.94627 6.80461 2.61493 6.62632C3.28358 6.44803 3.86269 6.29946 3.89851 6.29946C3.95224 6.29946 3.97015 6.47775 3.95821 6.99478L3.9403 7.69604L2.6209 8.05261C1.89851 8.24873 1.27761 8.43296 1.23582 8.45673C1.14627 8.51616 1.13433 9.84142 1.22388 9.89491C1.27164 9.92462 2.9194 9.50862 3.86866 9.23525C3.96418 9.20553 3.97015 9.29468 3.97015 10.513V11.8263L4.11343 11.9214C4.23881 11.9987 4.40597 12.0106 5.06866 11.9927C5.51045 11.9809 5.89254 11.9511 5.92239 11.9274C5.94627 11.8977 5.98209 11.1548 6 10.2693L6.02985 8.65879L7.34328 8.30816C8.30448 8.05261 8.68657 7.92781 8.76418 7.83273C8.89552 7.67821 8.91343 6.59066 8.78209 6.48369C8.72239 6.4302 8.42388 6.48963 7.51642 6.73329C6.8597 6.91158 6.25672 7.07204 6.16716 7.09581L6 7.13146V6.41832C6 6.02609 6.01791 5.70517 6.04776 5.70517C6.07164 5.70517 6.6806 5.54471 7.40299 5.3486C8.27463 5.11683 8.7403 4.96231 8.78806 4.89694C8.86567 4.78997 8.90149 3.77968 8.82985 3.60139C8.81194 3.5479 8.74627 3.5063 8.69254 3.5063C8.63881 3.5063 8.04776 3.65488 7.37313 3.83316C6.69851 4.01145 6.11343 4.16002 6.07761 4.16002C6.01791 4.16002 6 3.90448 6 3.0903V2.02058H7.9403C9.79104 2.02058 9.8806 2.01464 9.9403 1.90767C9.97015 1.84229 10 1.43224 10 0.986519C10 0.338745 9.98209 0.166401 9.90448 0.0950861C9.8209 0.0118857 9.29552 -6.62296e-08 4.99701 -6.62296e-08C2.05373 -6.62296e-08 0.143284 0.0237715 0.0895522 0.0594288Z" fill="#3C4242"/>
                            </svg>
                        </div>
                    </li>
                </ul>
            </div>
        </section>
    </section>
    )
}
